{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "cc850bf6_2a4f5c41",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1883347
      },
      "writtenOn": "2024-08-15T19:23:24Z",
      "side": 1,
      "message": "Initial version of the changes. This may get modified when I\u0027m testing it out later with full changes. \n\nPlease have initial look if you can see something that needs to be changed immediately, though.",
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6e3e1902_6c51eb68",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1798295
      },
      "writtenOn": "2024-08-16T17:55:47Z",
      "side": 1,
      "message": "If this is specific to display change, I wonder if we could name it like display_changed_wait_queue_head?",
      "range": {
        "startLine": 30,
        "startChar": 24,
        "endLine": 30,
        "endChar": 43
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ee8c48d8_69cc7fca",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1883347
      },
      "writtenOn": "2024-08-16T20:06:31Z",
      "side": 1,
      "message": "Thanks for suggestion, changed.",
      "parentUuid": "6e3e1902_6c51eb68",
      "range": {
        "startLine": 30,
        "startChar": 24,
        "endLine": 30,
        "endChar": 43
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "80a20889_abde31eb",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 439,
      "author": {
        "id": 1798295
      },
      "writtenOn": "2024-08-16T17:55:47Z",
      "side": 1,
      "message": "This might be better as a pr_debug.",
      "range": {
        "startLine": 439,
        "startChar": 1,
        "endLine": 439,
        "endChar": 28
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "88d84bb6_35bcfa9e",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 439,
      "author": {
        "id": 1883347
      },
      "writtenOn": "2024-08-16T20:06:31Z",
      "side": 1,
      "message": "Good point, switched to `dev_dbg` for the consistency with other log entries in the similar functions.",
      "parentUuid": "80a20889_abde31eb",
      "range": {
        "startLine": 439,
        "startChar": 1,
        "endLine": 439,
        "endChar": 28
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02688f52_e5e28566",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1798295
      },
      "writtenOn": "2024-08-16T17:55:47Z",
      "side": 1,
      "message": "What happens if multiple processes poll at the same time? Ideally they would all be signaled in the same way, but I think in this case they may get different return values.",
      "range": {
        "startLine": 440,
        "startChar": 16,
        "endLine": 440,
        "endChar": 39
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a7764d11_1f3bcec1",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1883347
      },
      "writtenOn": "2024-08-16T18:05:20Z",
      "side": 1,
      "message": "I\u0027m not sure why multiple processes would be polling on that device\u0027s fd. This is meant to be specifically for one consumer - hwc event listener, similar to DrmEventListener. There should be only one instance of that, as there should be just one instance of the hwc.",
      "parentUuid": "02688f52_e5e28566",
      "range": {
        "startLine": 440,
        "startChar": 16,
        "endLine": 440,
        "endChar": 39
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cc88721d_71801a09",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1798295
      },
      "writtenOn": "2024-08-16T20:15:41Z",
      "side": 1,
      "message": "It would be nice to support polling by multiple processes though, and I don\u0027t think it would be too hard.  What if we did this:\n\n1. We change dxgglobal-\u003edisplay_change_signaled to be dxgglobal-\u003elast_display_change_id, which stores the change id sent from the host. \n2. We add a new field on dxgprocess, that stores the last polled display change id.\n3. When a dxgproces is created, we set dxgprocess-\u003elast_polled_display_change_id \u003d dxgglobal-\u003elast_display_change_id.\n4. When a display changed event comes from the host, we set dxgglobal-\u003elast_display_change_id to the new change id rather than setting display_changed_signaled to true. Otherwise do the same thing we\u0027re doing now.\n5. I this function, the dxgprocess can be accessed via f-\u003eprivate_data. If dxgprocess-\u003elast_polled_display_change_id is less than dxgglobal-\u003elast_display_change_id, then you return pollin|pollrdnorm, and you update dxgprocess-\u003elast_polled_display_change_id.",
      "parentUuid": "a7764d11_1f3bcec1",
      "range": {
        "startLine": 440,
        "startChar": 16,
        "endLine": 440,
        "endChar": 39
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2414dbe0_d88edda8",
        "filename": "virtio_dxgkrnl/dxgglobal.c",
        "patchSetId": 1
      },
      "lineNbr": 440,
      "author": {
        "id": 1798295
      },
      "writtenOn": "2024-08-16T20:19:47Z",
      "side": 1,
      "message": "Though I\u0027m also not 100% sure it\u0027s possible for multiple threads/processes to call poll_wait on the same wait_queue_head. If not, then it becomes more complicated, and I\u0027d be fine deferring this to a future CL.",
      "parentUuid": "cc88721d_71801a09",
      "range": {
        "startLine": 440,
        "startChar": 16,
        "endLine": 440,
        "endChar": 39
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "55e93852_dcec079b",
        "filename": "virtio_dxgkrnl/virtio_dxgkrnl.c",
        "patchSetId": 1
      },
      "lineNbr": 216,
      "author": {
        "id": 1952016
      },
      "writtenOn": "2024-08-16T12:00:51Z",
      "side": 1,
      "message": "I think you forgot a `break;` here (otherwise, add a comment).",
      "range": {
        "startLine": 216,
        "startChar": 0,
        "endLine": 216,
        "endChar": 27
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "914dc786_ca237f66",
        "filename": "virtio_dxgkrnl/virtio_dxgkrnl.c",
        "patchSetId": 1
      },
      "lineNbr": 216,
      "author": {
        "id": 1883347
      },
      "writtenOn": "2024-08-16T20:06:31Z",
      "side": 1,
      "message": "Of course, thanks for catching!",
      "parentUuid": "55e93852_dcec079b",
      "range": {
        "startLine": 216,
        "startChar": 0,
        "endLine": 216,
        "endChar": 27
      },
      "revId": "13a1d2a2aaba4b0a66bc57972326d2ddae97191b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}